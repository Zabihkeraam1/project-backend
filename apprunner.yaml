# version: 1.0
# runtime: python311

# build:
#   commands:
#     pre-build:
#       - echo "âœ… Pre-build step started"
#     build:
#       - mkdir -p /app
#       - cp -r ./backend/* /app
#       - pip3 install --upgrade pip
#       - pip3 install -r /app/requirements.txt
#     post-build:
#       - echo "âœ… Post-build step complete"
# run:
#   runtime-version: 3.11
#   command: python3 -m uvicorn backend.main:app --host 0.0.0.0 --port 8080
#   network:
#     port: 8080


# version: 1.0
# runtime: python311

# build:
#   commands:
#     pre-build:
#       - echo "ðŸš€ Starting Python 3.11 build process..."
#     build:
#       - mkdir -p /app/.python-packages
#       - cp -r ./backend/* /app
#       - pip3 install --upgrade pip
#       # Install with PYTHONPATH set
#       - PYTHONPATH=/app/.python-packages pip3 install --target=/app/.python-packages uvicorn fastapi
#       - PYTHONPATH=/app/.python-packages pip3 install --target=/app/.python-packages -r /app/requirements.txt
#       # Verification with PYTHONPATH
#       - PYTHONPATH=/app/.python-packages python3 -c "import uvicorn; print(f'âœ… Uvicorn {uvicorn.__version__} installed at {uvicorn.__file__}')"
#       - echo "Python path:"
#       - PYTHONPATH=/app/.python-packages python3 -c "import sys; print(sys.path)"
#     post-build:
#       - echo "ðŸ“¦ Build completed successfully!"

# run:
#   command: PYTHONPATH=/app/.python-packages:/app python3 -m uvicorn backend.main:app --host 0.0.0.0 --port 8080
#   network:
#     port: 8080


version: 1.0
runtime: python311

build:
  commands:
    pre-build:
      - echo "ðŸš€ Starting build process..."
    build:
      - mkdir -p /app/.python-packages
      - cp -r ./backend/* /app
      - pip3 install --upgrade pip
      - pip3 install --target=/usr/local/lib/python3.11/site-packages uvicorn fastapi
      - pip3 install --target=/usr/local/lib/python3.11/site-packages -r /app/requirements.txt
      # Verification
      - python -c "import uvicorn; print(f'âœ… Uvicorn {uvicorn.__version__} verified')"
    post-build:
      - echo "ðŸ“¦ Build completed successfully"

run:
  command: python3 -m uvicorn backend.main:app --host 0.0.0.0 --port 8080
  network:
    port: 8080
